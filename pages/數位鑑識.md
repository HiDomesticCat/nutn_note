public:: true

- ## å‰è¨€
	- ### è³‡æ–™ä¾†æº
		- https://volatilityfoundation.org/
		- https://github.com/volatilityfoundation/volatility/wiki/Memory-Samples
- # ç›®éŒ„
	- ((67c1297d-745d-4d0b-bc4e-5a0eb20cc502))
- # Volatility å®‰è£æ•™å­¸
	- `å¾…å¯«`
- # Volatility å­¸ç¿’ - 2009 M57-Patents Scenario
  id:: 67c1297d-745d-4d0b-bc4e-5a0eb20cc502
  collapsed:: true
	- æœ¬ç« ç¯€è‘—é‡æ–¼**è¨˜æ†¶é«”å–è­‰**ï¼Œå°‡ä½¿ç”¨çš„å·¥å…·ç‚º Volatility2
	- # èƒŒæ™¯ä»‹ç´¹
		- ## ğŸ“– æƒ…å¢ƒä»‹ç´¹ (Scenario Background)
			- 2009å¹´çš„ **M57-Patents Scenario** æ˜¯ç”±ç¾åœ‹ **Naval Postgraduate School (NPS)** æä¾›çš„ç¶“å…¸æ•¸ä½é‘‘è­˜æ•™å­¸æ¡ˆä¾‹ï¼Œç›®æ¨™åœ¨æä¾›ä¸€å€‹çœŸå¯¦ä¸”å®Œæ•´çš„è™›æ“¬çŠ¯ç½ªç¾å ´ (Cyber Crime Scene)ï¼Œä¾›é‘‘è­˜å°ˆæ¥­äººå“¡èˆ‡å­¸ç”Ÿé€²è¡Œè¨“ç·´èˆ‡ç ”ç©¶ã€‚
			- æ¡ˆä¾‹çš„ä¸»é«”æ˜¯ **M57 Patents å…¬å¸**ï¼Œé€™æ˜¯ä¸€å®¶è™›æ§‹çš„å°ˆåˆ©å…¬å¸ï¼Œä¸»è¦æ¥­å‹™ç‚ºå°ˆåˆ©ç”³è«‹ã€æˆæ¬ŠåŠå°ˆåˆ©ç›¸é—œçš„å•†æ¥­è«®è©¢æœå‹™ã€‚å…¬å¸é­é‡äº†ä¸€ç³»åˆ—å…§éƒ¨äº‹ä»¶ï¼ŒåŒ…æ‹¬å“¡å·¥æ¶‰å«Œï¼š
				- **éæ³•ä¾µå…¥**
				- **çŸ¥è­˜ç”¢æ¬Šå·ç«Š (å°ˆåˆ©æ–‡ä»¶ç«Šå–)**
				- **ä¸ç•¶ä½¿ç”¨é›»è…¦èˆ‡ç¶²è·¯è³‡æº**
			- å› æ­¤ï¼Œå°‡é€éæ•¸ä½é‘‘è­˜æŠ€è¡“ï¼Œå¾è©²å…¬å¸å“¡å·¥çš„é›»è…¦ç¡¬ç¢Ÿæ˜ åƒèˆ‡è¨˜æ†¶é«”æ“·å–è³‡æ–™ä¸­ï¼ŒæŒ–æ˜è­‰æ“šä¸¦é‚„åŸäº‹å¯¦çœŸç›¸ã€‚
		- ## ğŸ¢ å…¬å¸è³‡è¨Šèˆ‡å“¡å·¥è§’è‰²ï¼š
			- **M57-Patents å…¬å¸**ï¼š
				- ä½æ–¼ç¾åœ‹ï¼Œä¸»è¦å¾äº‹å°ˆåˆ©ç›¸é—œæ¥­å‹™ã€‚
				- å“¡å·¥è¦æ¨¡å°ï¼Œç´„ 4~5 åå“¡å·¥ã€‚
			- **é‡è¦äººç‰©èˆ‡è§’è‰²ï¼š**
				- **Jo Smith (CEO)**ï¼šåŸ·è¡Œé•·ï¼ŒæŒæ§å…¬å¸æ ¸å¿ƒè³‡è¨Šã€‚
				- **Charlie Brown (ç ”ç™¼ä¸»ç®¡)**ï¼šæŠ€è¡“ç ”ç™¼ã€å°ˆåˆ©è³‡æ–™ç®¡ç†ï¼Œå…·å‚™å¤§é‡æ©Ÿå¯†æ–‡ä»¶ã€‚
				- **Terry Johnson (è¡Œæ”¿å“¡å·¥)**ï¼šæ—¥å¸¸ç®¡ç†ã€å“¡å·¥æºé€šã€ä¸€èˆ¬è¡Œæ”¿äº‹å‹™ã€‚
				- **Pat McGee (å“¡å·¥)**ï¼šæŠ€è¡“äººå“¡ä¹‹ä¸€ã€‚
				- å…¶ä»–å¯èƒ½ç›¸é—œäººå“¡ï¼ˆä¾‹å¦‚ï¼šIT äººå“¡ï¼‰ã€‚
			- ## ğŸš¨ äº‹ä»¶æ¦‚è¦ (Scenario Overview)
				- å…¬å¸å…§éƒ¨ç™¼ç¾æ©Ÿå¯†è³‡æ–™å¤–æ´©æˆ–é­éæ³•è¤‡è£½ã€‚
				- ç™¼ç¾æœ‰äººç–‘ä¼¼åˆ©ç”¨å…¬å¸è³‡æºé€²è¡Œéæ³•è¡Œç‚ºï¼ˆå¦‚éæ³•ä¸‹è¼‰ã€æ¿«ç”¨ç¶²è·¯è³‡æºï¼‰ã€‚
				- æœ‰è­‰æ“šé¡¯ç¤ºè‡³å°‘ä¸€åå“¡å·¥åˆ©ç”¨ USB éš¨èº«ç¢Ÿã€ç¶²è·¯å‚³è¼¸ç­‰æ–¹å¼å°‡å…¬å¸æ©Ÿå¯†è³‡æ–™å¤–æ´©ï¼Œä¸¦ä¼åœ–æ©è“‹è‡ªå·±çš„è¡Œè¹¤ã€‚
				- å…¬å¸è˜è«‹ä½ ï¼ˆæ•¸ä½é‘‘è­˜å°ˆå®¶ï¼‰èª¿æŸ¥è©²èµ·äº‹ä»¶ï¼Œå¾ç›¸é—œçš„ç£ç¢Ÿæ˜ åƒèˆ‡è¨˜æ†¶é«”æ“·å–æª”æ¡ˆä¸­æ‰¾åˆ°è­‰æ“šï¼Œæ‰¾å‡ºçŠ¯ç½ªè¡Œç‚ºçš„ç¢ºåˆ‡è­‰æ“šï¼Œä¸¦è¿½æŸ¥æ¶‰æ¡ˆå“¡å·¥ã€‚
		- ## ğŸ’» å¯ä¾›åˆ†æçš„æ•¸ä½é‘‘è­˜è­‰æ“šï¼š
			- æ­¤å ´æ™¯æä¾›äº†å¤šå€‹é›»è…¦ç£ç¢Ÿæ˜ åƒèˆ‡è¨˜æ†¶é«”æ“·å–æª”æ¡ˆï¼š
			- **ç£ç¢Ÿæ˜ åƒ (Disk Images)**ï¼š
				- å“¡å·¥é›»è…¦çš„å®Œæ•´ç£ç¢Ÿæ˜ åƒï¼ˆå¦‚E01æª”ï¼‰ã€‚
				- ç£ç¢Ÿå…§å«æ“ä½œç³»çµ±ã€ç¨‹å¼ã€ä½¿ç”¨è€…è³‡æ–™ã€ç€è¦½å™¨æ­·å²ç´€éŒ„ç­‰ã€‚
			- **è¨˜æ†¶é«”æ“·å–æª”æ¡ˆ (Memory Dumps)**ï¼š
				- å„å€‹å“¡å·¥é›»è…¦çš„è¨˜æ†¶é«” (RAM) æ˜ åƒæª”æ¡ˆã€‚
				- é€éè¨˜æ†¶é«”åˆ†æï¼ˆå¦‚ Volatilityï¼‰é‡å»ºäº‹ç™¼ç•¶æ™‚é›»è…¦ä½¿ç”¨ç‹€æ…‹ã€‚
		- ## ğŸ” ä½ å°‡èª¿æŸ¥çš„ä¸»è¦ä»»å‹™ï¼š
			- é€éæ•¸ä½é‘‘è­˜æŠ€è¡“èª¿æŸ¥ä»¥ä¸‹å•é¡Œï¼š
				- å“ªä½å“¡å·¥æ¶‰åŠç«Šå–å…¬å¸æ©Ÿå¯†è³‡æ–™ï¼Ÿ
				- ä½¿ç”¨ä»€éº¼æ‰‹æ³•ï¼ˆå¦‚ USB æˆ–ç¶²è·¯ï¼‰å°‡è³‡æ–™å¤–æ´©ï¼Ÿ
				- å¤–æ´©äº†å“ªäº›æ©Ÿå¯†è³‡æ–™ï¼ˆä¾‹å¦‚å“ªäº›å°ˆåˆ©æ–‡ä»¶ï¼‰ï¼Ÿ
				- ç›¸é—œå“¡å·¥é€²è¡Œäº†å“ªäº›å…·é«”è¡Œç‚ºï¼ˆä¾‹å¦‚åˆ»æ„æ©è“‹è¡Œç‚ºã€åˆªé™¤æ­·å²ç´€éŒ„ï¼‰ï¼Ÿ
	- ## å–å¾—å–è­‰æ•¸æ“š
		- å…ˆå¾å®˜æ–¹æä¾›çš„ä¸‹è¼‰é»å–å¾—
			- https://digitalcorpora.org/corpora/scenarios/m57-patents-scenario/
			- å®˜æ–¹æä¾›çš„ç‚º win xp çš„è¨˜æ†¶é«”è¨˜éŒ„æª” (.mddramimage)ï¼Œé ˆæ³¨æ„ç”±æ–¼ç³»çµ±è¼ƒèˆŠï¼Œæ‰€ä»¥è«‹ä½¿ç”¨ Volatility2
			- å®˜æ–¹æä¾›å¤šä½ä½¿ç”¨è€…åœ¨ä¸€å€‹ç¦®æ‹œä¸­çš„å¹¾å¤©çš„ç´€éŒ„æª”ï¼Œæ¯å€‹è¨˜éŒ„æª”è¼ƒå¤§ï¼Œæˆ‘å€‘å°‡é€ä¸€é€²è¡Œæª¢æŸ¥
		- æå– `charlie-2009-11-16.mddramimage` è³‡è¨Š
			- æå–è¨˜éŒ„æª”è¨Šæ¯
				- ```shell
				  â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents/volatility]
				  â””â”€$ python2 vol.py -f charlie-2009-11-16.mddramimage imageinfo
				  Volatility Foundation Volatility Framework 2.6.1
				  INFO    : volatility.debug    : Determining profile based on KDBG search...
				            Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)
				                       AS Layer1 : IA32PagedMemory (Kernel AS)
				                       AS Layer2 : FileAddressSpace (/home/kali/Documents/volatility/charlie-2009-11-16.mddramimage)
				                        PAE type : No PAE
				                             DTB : 0x39000L
				                            KDBG : 0x805532e0L
				            Number of Processors : 2
				       Image Type (Service Pack) : 3
				                  KPCR for CPU 0 : 0xffdff000L
				                  KPCR for CPU 1 : 0xf7717000L
				               KUSER_SHARED_DATA : 0xffdf0000L
				             Image date and time : 2009-11-17 00:26:38 UTC+0000
				       Image local date and time : 2009-11-16 16:26:38 -0800
				  ```
			- æå–ç•¶æ™‚é€²ç¨‹è³‡è¨Š
				- ```shell
				  â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents/volatility]
				  â””â”€$ python2 vol.py -f charlie-2009-11-16.mddramimage --profile=WinXPSP2x86 pslist
				  Volatility Foundation Volatility Framework 2.6.1
				  Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          
				  ---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
				  0x89bfb9c8 System                    4      0     66      555 ------      0                                                              
				  0x894b9900 smss.exe                884      4      3       19 ------      0 2009-11-13 04:47:59 UTC+0000                                 
				  0x899143d0 csrss.exe               932    884     13      665      0      0 2009-11-13 04:48:00 UTC+0000                                 
				  0x8999b888 winlogon.exe            956    884     20      652      0      0 2009-11-13 04:48:00 UTC+0000                                 
				  0x89512da0 services.exe           1000    956     18      378      0      0 2009-11-13 04:48:01 UTC+0000                                 
				  0x894b79f8 lsass.exe              1012    956     23      359      0      0 2009-11-13 04:48:01 UTC+0000                                 
				  0x895057e8 svchost.exe            1188   1000     16      199      0      0 2009-11-13 04:48:01 UTC+0000                                 
				  0x89a7b300 svchost.exe            1276   1000     10      279      0      0 2009-11-13 04:48:01 UTC+0000                                 
				  0x89919a58 svchost.exe            1400   1000     78     1606      0      0 2009-11-13 04:48:02 UTC+0000                                 
				  0x89936ad0 svchost.exe            1544   1000      5       86      0      0 2009-11-13 04:48:02 UTC+0000                                 
				  0x8945b270 svchost.exe            1600   1000     12      175      0      0 2009-11-13 04:48:02 UTC+0000                                 
				  0x89b02310 avgchsvx.exe           1692    956     23      278      0      0 2009-11-13 04:48:02 UTC+0000                                 
				  0x89b02a18 avgrsx.exe             1700    956     28      241      0      0 2009-11-13 04:48:02 UTC+0000                                 
				  0x89bb9da0 avgcsrvx.exe           1844   1700      8      168      0      0 2009-11-13 04:48:03 UTC+0000                                 
				  0x898d8368 spoolsv.exe            2044   1000     10      110      0      0 2009-11-13 04:48:03 UTC+0000                                 
				  0x898fa2c8 AVGIDSAgent.exe         224   1000     32      528      0      0 2009-11-13 04:48:04 UTC+0000                                 
				  0x89a2ab28 explorer.exe            488    416     12      525      0      0 2009-11-13 04:48:05 UTC+0000                                 
				  0x89a78860 hkcmd.exe               680    488      2      104      0      0 2009-11-13 04:48:08 UTC+0000                                 
				  0x8994ea28 avgtray.exe             692    488     18      315      0      0 2009-11-13 04:48:08 UTC+0000                                 
				  0x894e7430 jusched.exe             704    488      1       40      0      0 2009-11-13 04:48:08 UTC+0000                                 
				  0x898c3a40 ctfmon.exe              740    488      1       75      0      0 2009-11-13 04:48:08 UTC+0000                                 
				  0x894beda0 AVGIDSMonitor.e         772    692      3       37      0      0 2009-11-13 04:48:09 UTC+0000                                 
				  0x89401bc0 svchost.exe             676   1000      5      109      0      0 2009-11-13 04:48:19 UTC+0000                                 
				  0x89909da0 avgwdsvc.exe            904   1000     43     1486      0      0 2009-11-13 04:48:20 UTC+0000                                 
				  0x89ae4020 avgfws9.exe            1080   1000     30      865      0      0 2009-11-13 04:48:21 UTC+0000                                 
				  0x893f7bc0 jqs.exe                1356   1000      5      123      0      0 2009-11-13 04:48:21 UTC+0000                                 
				  0x893569e0 avgemc.exe             2404   1000     21      601      0      0 2009-11-13 04:48:25 UTC+0000                                 
				  0x8931c648 avgam.exe              2440    904     15      293      0      0 2009-11-13 04:48:26 UTC+0000                                 
				  0x8931ada0 avgnsx.exe             2484    904     25      339      0      0 2009-11-13 04:48:26 UTC+0000                                 
				  0x892b18d8 avgcsrvx.exe           2908   2404      3      115      0      0 2009-11-13 04:48:27 UTC+0000                                 
				  0x8925d4c0 alg.exe                 292   1000      6      109      0      0 2009-11-13 04:48:33 UTC+0000                                 
				  0x8927e020 avgcsrvx.exe           2672   2484      7      175      0      0 2009-11-13 04:54:31 UTC+0000                                 
				  0x891ff020 thunderbird.exe        3648    488     11      198      0      0 2009-11-16 19:46:41 UTC+0000                                 
				  0x89b53848 avgsrmax.exe           1076    904      0 --------      0      0 2009-11-16 19:59:51 UTC+0000   2009-11-16 19:59:51 UTC+0000  
				  0x891ba2d0 firefox.exe            3080    488     12      288      0      0 2009-11-16 20:01:51 UTC+0000                                 
				  0x89b48020 avgcmgr.exe            2144    904      0 --------      0      0 2009-11-16 20:34:47 UTC+0000   2009-11-16 20:34:47 UTC+0000  
				  0x8914f558 avgcmgr.exe            4072    904      0 --------      0      0 2009-11-17 00:12:15 UTC+0000   2009-11-17 00:12:15 UTC+0000  
				  0x8917d680 cmd.exe                1680    488      1       33      0      0 2009-11-17 00:25:48 UTC+0000                                 
				  0x8915fda0 mdd_1.3.exe            3320   1680      1       24      0      0 2009-11-17 00:26:37 UTC+0000                                 
				  ```
				- ### ğŸ”  **é—œéµè§€å¯Ÿé»ï¼š**
					- `explorer.exe (PID 488)`
					  æ˜¯ä½œæ¥­ç³»çµ±çš„ä½¿ç”¨è€…ä»‹é¢ (UI) ç¨‹åºï¼Œé€šå¸¸ä»£è¡¨ä½¿ç”¨è€…ç™»å…¥ç³»çµ±å¾Œçš„æ¡Œé¢ç’°å¢ƒã€‚
					- `cmd.exe (PID 1680)`
					  ç›´æ¥ç”± `explorer.exe` å•Ÿå‹•ï¼Œä»£è¡¨ä½¿ç”¨è€…æ‰‹å‹•é–‹å•Ÿå‘½ä»¤æç¤ºå­—å…ƒã€‚
					- `mdd_1.3.exe (PID 3320)`
					  æ˜¯ç”± `cmd.exe` å•Ÿå‹•ï¼Œé€™è¡¨ç¤ºä½¿ç”¨è€…é€šéå‘½ä»¤æç¤ºå­—å…ƒä¾†åŸ·è¡Œ `mdd_1.3.exe`ï¼Œ
					  **å¯èƒ½ä»£è¡¨æ­£åœ¨é€²è¡Œè¨˜æ†¶é«”è½‰å„² (Memory Dump)**ã€‚
					- `jusched.exe (PID 704)`ã€`hkcmd.exe (PID 680)`ã€`ctfmon.exe (PID 740)`
					  é€™äº›é€šå¸¸æ˜¯ç³»çµ±çš„å¸¸é§ç¨‹å¼ã€‚
					- `avgtray.exe` å’Œ `AVGIDSMonitor.e`
					  AVGé˜²æ¯’è»Ÿé«”çš„é€²ç¨‹ï¼Œè¡¨ç¤ºç³»çµ±æœ‰å®‰è£é˜²æ¯’è»Ÿé«”ã€‚
					- `firefox.exe` èˆ‡ `thunderbird.exe`
					  ä»£è¡¨ä½¿ç”¨è€…æ­£åœ¨ä½¿ç”¨ç€è¦½å™¨åŠéƒµä»¶è»Ÿé«”ã€‚
			- ä¸¦æœªåœ¨æ­¤ç´€éŒ„æª”ä¸­å–å¾—é‡è¦è³‡è¨Š
		- æå–`charlie-2009-11-18.mddramimage` è³‡è¨Š
			- ç™¼ç¾å¯ç–‘é€£ç·šæƒ…æ³
				- ```shell
				  â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents/volatility]
				  â””â”€$ python2 vol.py -f charlie-2009-11-18.mddramimage --profile=WinXPSP2x86 connscan                                            
				  Volatility Foundation Volatility Framework 2.6.1
				  Offset(P)  Local Address             Remote Address            Pid
				  ---------- ------------------------- ------------------------- ---
				  0x08d7c8c8 192.168.1.104:1929        192.168.1.1:445           4
				  0x08dbc850 127.0.0.1:4242            127.0.0.1:1917            2172
				  0x08dc2320 192.168.1.104:1763        198.189.255.73:80         2172
				  0x08e12008 192.168.1.104:1910        198.189.255.75:80         1204
				  0x08e12ba8 192.168.1.104:1924        192.168.1.1:139           4
				  0x091d1008 127.0.0.1:1692            127.0.0.1:1691            968
				  0x091fcd08 127.0.0.1:4242            127.0.0.1:1926            2172
				  0x09226d08 192.168.1.104:1909        212.96.161.238:80         1204
				  0x0922c008 127.0.0.1:1381            127.0.0.1:1380            2172
				  0x09278868 192.168.1.104:1928        192.168.1.1:139           4
				  0x092f4400 208.202.171.137:0         0.0.0.0:0                 0
				  0x092f5638 127.0.0.1:1691            127.0.0.1:1692            968
				  0x093abe68 127.0.0.1:1690            127.0.0.1:1689            968
				  0x093aee68 192.168.1.104:1930        192.168.1.1:139           4
				  0x0941e940 127.0.0.1:1373            127.0.0.1:1372            2172
				  0x094474b8 127.0.0.1:5152            127.0.0.1:1378            308
				  0x09a3fe68 127.0.0.1:1689            127.0.0.1:1690            968
				  0x09b633f0 144.101.180.137:56968     80.115.67.97:63654        2296138544
				  ```
				- å¾åœ¨æ€ªç•°çš„ pid è³‡è¨Š (2296138544)ï¼Œå¯ä»¥ä»¥æ­¤ç‚ºåˆ‡å…¥é»
			- ç™¼ç¾ä½¿ç”¨è€…ä¸‹éå¯ç–‘æŒ‡ä»¤ä¸¦åŸ·è¡Œäº†å¯ç–‘ python ç¨‹å¼
				- ```shell
				  â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents/volatility]
				  â””â”€$ python2 vol.py -f charlie-2009-11-18.mddramimage --profile=WinXPSP2x86 cmdscan                                             
				  Volatility Foundation Volatility Framework 2.6.1
				  **************************************************
				  CommandProcess: csrss.exe Pid: 924
				  CommandHistory: 0x4f4660 Application: cmd.exe Flags: Allocated, Reset
				  CommandCount: 6 LastAdded: 5 LastDisplayed: 5
				  FirstCommand: 0 CommandCountMax: 50
				  ProcessHandle: 0x7b0
				  Cmd #0 @ 0x1238fd0: cd desktop
				  Cmd #1 @ 0x1238ff0: cd web
				  Cmd #2 @ 0x4f1f90: dir
				  Cmd #3 @ 0x1244508: python patentauto.py
				  Cmd #4 @ 0x4f1fa0: c:\Python26\python.exe patentauto.py
				  Cmd #5 @ 0x1244458: z:\mdd_1.3.exe -o z:\charlie-2009-11-18.ram
				  **************************************************
				  CommandProcess: csrss.exe Pid: 924
				  CommandHistory: 0x12386f8 Application: avgidsmonitor.exe Flags: Allocated
				  CommandCount: 0 LastAdded: -1 LastDisplayed: -1
				  FirstCommand: 0 CommandCountMax: 50
				  ProcessHandle: 0xa64
				  **************************************************
				  CommandProcess: csrss.exe Pid: 924
				  CommandHistory: 0x1250c40 Application: mdd_1.3.exe Flags: Allocated
				  CommandCount: 0 LastAdded: -1 LastDisplayed: -1
				  FirstCommand: 0 CommandCountMax: 50
				  ProcessHandle: 0x5dc
				  ```
			- æ·±å…¥èª¿æŸ¥ç™¼ç¾å­˜åœ¨å¤šå€‹å¯ç–‘æ–‡ä»¶
				- ```shell
				  â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents/volatility]
				  â””â”€$ python2 vol.py -f charlie-2009-11-18.mddramimage --profile=WinXPSP2x86 filescan | grep -i ".pdf\|patent"                   
				  Volatility Foundation Volatility Framework 2.6.1
				  0x0000000008db3700      1      0 R--rw- \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\patentauto.py
				  0x0000000008ebaae0      1      0 R--rw- \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\patentterms.txt
				  0x0000000009011028      1      0 R--r-- \Device\HarddiskVolume1\Program Files\OpenOffice.org 3\Basis\share\config\wizard\web\images\pdf.gif
				  0x0000000009127c18      1      0 R--r-- \Device\HarddiskVolume1\Documents and Settings\Charlie\My Documents\22EE12E5d01.pdf
				  0x0000000009159028      1      0 R--r-- \Device\HarddiskVolume1\Program Files\Foxit Software\Foxit Reader\UnInstallPDFReaderPlugin.exe
				  0x00000000091ba528      1      0 R--r-- \Device\HarddiskVolume1\Documents and Settings\Charlie\My Documents\AC7640A9d01.pdf
				  0x00000000092994a0      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Charlie\Recent\urlspatents.lnk
				  0x000000000930aab8      1      0 R----- \Device\HarddiskVolume1\WINDOWS\Prefetch\INSTALLPDFREADERPLUGIN.EXE-18428CA0.pf
				  0x00000000093325a0      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\urlspatents.txt
				  0x00000000094e3468      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Charlie\Recent\patentauto.lnk
				  0x00000000094ffa70      1      0 R--r-- \Device\HarddiskVolume1\Program Files\OpenOffice.org 3\Basis\program\pdffiltermi.dll
				  
				  â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents/volatility]
				  â””â”€$ python2 vol.py -f charlie-2009-11-18.mddramimage --profile=WinXPSP2x86 filescan | grep -i ".pdf\|urls"                     
				  Volatility Foundation Volatility Framework 2.6.1
				  0x0000000008d8e948      1      0 R--rw- \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\urls.txt
				  0x0000000009011028      1      0 R--r-- \Device\HarddiskVolume1\Program Files\OpenOffice.org 3\Basis\share\config\wizard\web\images\pdf.gif
				  0x0000000009127c18      1      0 R--r-- \Device\HarddiskVolume1\Documents and Settings\Charlie\My Documents\22EE12E5d01.pdf
				  0x0000000009159028      1      0 R--r-- \Device\HarddiskVolume1\Program Files\Foxit Software\Foxit Reader\UnInstallPDFReaderPlugin.exe
				  0x00000000091ba528      1      0 R--r-- \Device\HarddiskVolume1\Documents and Settings\Charlie\My Documents\AC7640A9d01.pdf
				  0x0000000009291248      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\urlscopyright.txt
				  0x00000000092994a0      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Charlie\Recent\urlspatents.lnk
				  0x000000000930aab8      1      0 R----- \Device\HarddiskVolume1\WINDOWS\Prefetch\INSTALLPDFREADERPLUGIN.EXE-18428CA0.pf
				  0x00000000093325a0      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\urlspatents.txt
				  0x0000000009362698      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Charlie\Recent\urlspersona.lnk
				  0x000000000938d168      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\urlspersona.txt
				  0x00000000094ffa70      1      0 R--r-- \Device\HarddiskVolume1\Program Files\OpenOffice.org 3\Basis\program\pdffiltermi.dll
				  0x0000000009a96ea0      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\urlstime_machine.txt
				  ```
				- å¯ç–‘æ–‡ä»¶åŒ…å«`patentauto.py`, `patentterms.txt` èˆ‡ `urls.txt`
			- æå–å¯ç–‘æ–‡ä»¶ `patentauto.py`
				- ```shell
				  â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents/volatility]
				  â””â”€$ python2 vol.py -f charlie-2009-11-18.mddramimage --profile=WinXPSP2x86 dumpfiles -Q 0x0000000008db3700 -D ../malfind_output
				  Volatility Foundation Volatility Framework 2.6.1
				  DataSectionObject 0x08db3700   None   \Device\HarddiskVolume1\Documents and Settings\Charlie\Desktop\web\patentauto.py
				  ```
				- æª”å…§ç¨‹å¼ç¢¼
				  collapsed:: true
					- ```python
					  #! /usr/bin/python
					  
					  __author__="LCDR Kris Kearton"
					  __date__ ="$Aug 24, 2009 7:42:41 PM$"
					  # class: CS4920 ADOMEX
					  # System info: Running on OS 10.6 python ver 2.6.2
					  # Setup information:
					  #   (1) Install MozRepl Plugin at:
					  #       http://wiki.github.com/bard/mozrepl
					  #       Once installed, ensure in Firefox under tools MozRepl is started
					  #
					  # Summary: MozRepl needs to telnet to the browser via port 4242.  Once connected the port can program
					  # can issue commands directly to the web browser.  This program gets the list of urls from the text file.
					  # Then randomly picks a URL and surfs it for background noise.
					  
					  import time
					  import csv
					  import telnetlib
					  import robotparser
					  import os
					  import random
					  
					  #
					  #connect to MozRepl and fetch HTML
					  #
					  def connect_mozrepl(url_addr):
					      quit = False
					      t = telnetlib.Telnet("localhost", 4242)
					      t.read_until("repl>")
					  
					      #verifies page was accepted
					      rp = robotparser.RobotFileParser()
					      fetched = rp.can_fetch("*", url_addr)
					      print fetched
					      state = True
					      while(state==True):
					          if fetched==True:
					              rdm = random.random()*500
					              print rdm
					              time.sleep(rdm) #WAIT FOR WEBPAGE TO LOAD
					              str =  "content.location.href='"+url_addr.strip()+"'\n"
					              print str
					              t.write(str)
					              body = t.read_until("repl>")
					              state = False
					          else:
					              state = False
					              print "unable to fetch web page, exiting!!!"
					              quit = True
					              break
					      t.write("content.document.body.innerHTML\n")
					      body = t.read_until("repl>")
					  
					      t.close()
					  
					      return body, quit
					  
					  def urlMain():
					      quitflag = False
					      url = open("urls.txt", "r")
					  
					      #this goes through every url in the ???.txt file
					      for line in url:
					          #print line
					          hour = time.localtime()[3]
					          if (hour >= 9 and hour < 10) or (hour >= 13 and hour < 14) or (hour >= 16 and hour < 17):
					              html_body, quitflag = connect_mozrepl(line)
					              if quitflag==True:
					                  break
					          else:
					              break
					      print "Done\n"
					      
					  def patentMain():
					          quitflag = False
					          url = open("patentterms.txt", "r")
					  
					          #this goes through every url in the ???.txt file
					          for line in url:
					              #print line
					              hour = time.localtime()[3]
					              if (hour >= 10 and hour < 12) or (hour >= 14 and hour < 16):
					                  rdm = random.random() * int(line.split(',')[1])
					                  #http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=3343&f=G&l=50&co1=AND&d=PTXT&s1=cryptography&OS=cryptography&RS=cryptography
					                  print 'http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r='+repr(rdm)+'&f=G&l=50&co1=AND&d=PTXT&s1='+line.split(',')[0]+'&OS='+line.split(',')[0]+'&RS='+line.split(',')[0]
					                  html_body, quitflag = connect_mozrepl('http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r='+repr(rdm)+'&f=G&l=50&co1=AND&d=PTXT&s1='+line.split(',')[0]+'&OS='+line.split(',')[0]+'&RS='+line.split(',')[0])    
					                  if quitflag==True:
					                      break
					              else:
					                  break
					          print "Done\n"
					  
					  if __name__ == "__main__":
					      while(1):
					          hour = time.localtime()[3]
					          if (hour >= 9 and hour < 10) or (hour >= 13 and hour < 14) or (hour >= 16 and hour < 17):
					              print "Visiting Persona URLs..."
					              urlMain()
					          if (hour >= 10 and hour < 12) or (hour >= 14 and hour < 16):
					              print "Patent Searching..."
					              patentMain()
					  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
					  ```
		- ç¢ºèªé•æ³•æ­·ç¨‹
			- å¾ 2009 å¹´ 11æœˆ 18 è™Ÿé–‹å§‹åŸ·è¡Œ `patentauto.py`ï¼Œç«Šå–æ©Ÿå¯†æª”æ¡ˆ
				- æŒçºŒæ™‚é–“ 19ã€
-